<% @integrity = generate_wompi_signature("#{room_id}-#{current_user.id}", @amount, @currency, @wompi_integrity) %>

<%= form_tag("https://checkout.wompi.co/p/", method: "GET", id: "payment-form") do %>
  <%= hidden_field_tag "room-id", "", id: "room-id" %>
  <%= hidden_field_tag "public-key", ENV["WOMPI_PUBLIC_KEY"] %>
  <%= hidden_field_tag "currency", @currency %>
  <%= hidden_field_tag "amount-in-cents", @amount %>
  <%= hidden_field_tag "reference", "#{room_id}-#{current_user.id}" %>
  <%= hidden_field_tag "signature:integrity", @integrity %>
  <%= hidden_field_tag "redirect-url", "https://be0a-181-204-210-58.ngrok-free.app/pagos/respuesta" %>
  <%= hidden_field_tag 'customer-data:email', current_user.email %>
  <%= hidden_field_tag 'customer-data:full-name', current_user.first_name %>
  <%= hidden_field_tag 'customer-data:phone-number', current_user.phone %>

  <%= submit_tag "Pagar con Wompi" %>
<% end %>