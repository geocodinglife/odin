<main class="main-page">
  <div>
    <div class="category-area">
      <div class="cat-card-align ">
      <% @icons.each do |icon| %>
        <div class="cat-card">
          <%= image_tag icon.second, class:"category_image_link"%>
          <p><%= icon.first %></p>
        </div>
        <% end %>
      </div>
    </div>

  <div class="products">
    <% @products.each do |product| %>
      <div>
        <div class="ad-card">
          <div>
          <%= link_to(image_tag(product.images.first || 'https://imgd.aeplcdn.com/1056x594/n/cw/ec/105799/rumion-exterior-right-front-three-quarter-4.jpeg?isig=0&q=80&wm=1'), product_path(product)) %>
          </div>
          <div>
            <h2>Todas la categorias</h2>
            <h2 class="pricing"><%= product.category.name %></h2>
            </p>
          </div>
          <div>
            <p class="pricing">COP  $ <%= product.price %>
              <span class="heart-icon"> <i class="fa-regular fa-heart"></i></span>
            </p>
          </div>
          <div class="ad-desc">
            <p><%= product.name %></p>
          </div>
          <div class="ad-desc">
          <p><%= product.description.body %></p>
          </div>

          <div class="location">
            <p>Cartagena, Colombia. </p>
            <p class="small-txt">1 semana atras</p>
          </div>

          <button class="btn showModalButton" data-product-id="<%= product.id %>">Add Lead</button>
          <%= render "welcome/lead", locals: { product_id: product.id }  %>
        </div>
      </div>
    <% end %>
  </div>
</main>


<script>
  document.addEventListener('DOMContentLoaded', function () {
    const showModalButtons = document.querySelectorAll('.showModalButton');
    const modal = document.getElementById('modal');
    const closeModal = document.getElementById('closeModal');
    const productInput = document.getElementById('product');

    showModalButtons.forEach(function (button) {
      button.addEventListener('click', function () {
        modal.style.display = 'block';

        const productId = button.getAttribute('data-product-id');
        productInput.value = productId;
      });
    });

    closeModal.addEventListener('click', function () {
      modal.style.display = 'none';
    });

    window.addEventListener('click', function (event) {
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    });
  });
</script>